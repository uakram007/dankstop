{%- include 'lazyload-placeholder' -%} 

{% if settings.header_layout == 'default' %}
<a href="javascript:void(0)" title="Cart" class="cart-icon" data-cart-toggle>
    {% include 'icon-cart' %}
    <span class="cart-text"{% if settings.enable_multilang %} data-translate="cart.general.shopping_cart"{% endif %}>
        {{ 'cart.general.shopping_cart' | t }}
    </span>
    <span class="cartCount" data-cart-count>
{%- comment -%}
{{ cart.item_count }}
{%- endcomment -%}
{% include 'cart-item-count' %}
    </span>
</a>
{% endif %}

<div id="dropdown-cart" class="lazybit lazybit-load" data-lazy-method="replace" data-lazy-url="{{shop.url}}?view=cart-sidebar">
{%- comment -%}
  <div class="cart-title">
    <a href="javascript:void(0)" title="{{ 'cart.general.close_cart' | t }}" class="close-cart close">
      {% include 'icon-close' %}
      <span {% if settings.enable_multilang %}data-translate="cart.general.close_cart"{% endif %}>
        {{ 'cart.general.close_cart' | t }}
      </span>
    </a>
    
    <h5 {% if settings.enable_multilang %}data-translate="cart.general.shopping_cart"{% endif %}>
      {{ 'cart.general.shopping_cart' | t }}:
    </h5>
  </div>
  
  <div class="no-items">
    <p class="cart_empty" {% if settings.enable_multilang %}data-translate="cart.general.empty"{% endif %} >
      {{ 'cart.general.empty' | t }}
    </p>
    <div class="text-continue">
      <a class="btn btn-continue" href="/collections/all" {% if settings.enable_multilang %}data-translate="cart.ajax_cart.continue_shopping"{% endif %}>
        {{ 'cart.ajax_cart.continue_shopping' | t }}
      </a>
    </div>
  </div>

  <div class="has-items">
    <ol class="mini-products-list">  
      {% for item in cart.items %}
      
      {%- if item.properties != blank and item.properties._bundle_addon != blank -%}
      
      	{%- assign bundle_id = item.properties._bundle_addon -%}
      
        {%- if item.product.handle == settings.warranty__product -%}
          {%- assign warrantied_product = all_products[item.properties._item_name] -%}
          {%- assign warrantied_variant_id = item.properties._item_id | abs -%}
          {%- assign warrantied_product_id = warrantied_product.id -%}
          {%- assign warrantied_product_url = warrantied_product.url -%}
          {%- assign warrantied_product_title = warrantied_product.title -%}
          {%- for warrantied_variant in warrantied_product.variants -%}
            {%- if warrantied_variant.id == warrantied_variant_id -%}
            {%- assign warrantied_product_title = warrantied_product_title | append: " - " | append: warrantied_variant.title -%}
            {%- continue -%}
            {%- endif -%}
          {%- endfor -%}

          <li class="item" data-bundle-addon="{{ bundle_id }}" id="cart-item-{{item.id | append: "-" | append: forloop.index }}">
            <a href="{{item.url}}" class="product-image">
              <img class="lazyload" src="{{ lazyload_placeholder }}" data-src="{{ item.image | product_img_url: '160x' }}" alt="{{item.title}}">
            </a>

            <div class="product-details">
              <a href="javascript:void(0)" title="{{ 'cart.general.remove' | t }}" class="btn-remove">
                {% include 'icon-close' %}
              </a>

              <a class="product-name" href="{{item.url}}">
                {% include 'multilang' with item.product.title %}
              </a>

              <div class="option">
                For <small><a href="{{ warrantied_product_url }}" title="{{ warrantied_product_title }}" target="_blank" rel="noopener">{{ warrantied_product_title }}</a></small>
              </div>

              <div class="cart-collateral">
                <span class="price">
                  {{ item.quantity | times: item.price | money}}
                </span>
              </div>
            </div>
          </li>
      
        {%- else -%}
     
          <li class="item" data-bundle-addon="{{ bundle_id }}" id="cart-item-{{item.id}}">
            <a href="{{item.url}}" class="product-image">
              <img class="lazyload" src="{{ lazyload_placeholder }}" data-src="{{ item.image | product_img_url: '160x' }}" alt="{{item.title}}">
            </a>

            <div class="product-details">
              <a href="javascript:void(0)" title="{{ 'cart.general.remove' | t }}" class="btn-remove">
                {% include 'icon-close' %}
              </a>

              <a class="product-name" href="{{item.url}}">
                {% include 'multilang' with item.product.title %}
              </a>

              <div class="option">
                {% if item.product.variants.size != 0 %}
                {% unless item.variant.title contains 'Default' %}
                <small>{{ item.variant.title }}</small>
                {% endunless %}
                {% endif %}
              </div>

              <div class="cart-collateral">
                <span class="qtt">
                  {{item.quantity}} X
                </span>
                <span class="price">
                  {{item.price | money}}
                </span>
              </div>
            </div>
          </li>

        {%- endif -%}
      
      {%- elsif item.properties != blank and item.properties._bundle_id != blank -%}
     
      	{%- assign bundle_id = item.properties._bundle_id -%}
        <li class="item" data-bundle-addon="{{ bundle_id }}" id="cart-item-{{item.id}}">
          <a href="{{item.url}}" class="product-image">
            <img class="lazyload" src="{{ lazyload_placeholder }}" data-src="{{ item.image | product_img_url: '160x' }}" alt="{{item.title}}">
          </a>

          <div class="product-details">
            <a href="javascript:void(0)" title="{{ 'cart.general.remove' | t }}" class="btn-remove">
              {% include 'icon-close' %}
            </a>

            <a class="product-name" href="{{item.url}}">
              {% include 'multilang' with item.product.title %}
            </a>

            <div class="option">
              {% if item.product.variants.size != 0 %}
              {% unless item.variant.title contains 'Default' %}
              <small>{{ item.variant.title }}</small>
              {% endunless %}
              {% endif %}
            </div>

            <div class="cart-collateral">
              <span class="qtt">
                {{item.quantity}} X
              </span>
              <span class="price">
                {{item.price | money}}
              </span>
            </div>
          </div>
        </li>

      {%- else -%}

        <li class="item" id="cart-item-{{item.id}}" data-product-id="{{item.id}}">
          <a href="{{item.url}}" class="product-image">
            <img class="lazyload" src="{{ lazyload_placeholder }}" data-src="{{ item.image | product_img_url: '160x' }}" alt="{{item.title}}">
          </a>

          <div class="product-details">
            <a href="javascript:void(0)" title="{{ 'cart.general.remove' | t }}" class="btn-remove">
              {% include 'icon-close' %}
            </a>

            <a class="product-name" href="{{item.url}}">
              {% include 'multilang' with item.product.title %}
            </a>

            <div class="option">
              {% if item.product.variants.size != 0 %}
              {% unless item.variant.title contains 'Default' %}
              <small>{{ item.variant.title }}</small>
              {% endunless %}
              {% endif %}
            </div>

            <div class="cart-collateral">
              <span class="qtt">
                {{item.quantity}} X
              </span>
              <span class="price">
                {{item.price | money}}
              </span>
            </div>
          </div>
        </li>

      {%- endif -%}
      
      {% endfor %}
    </ol>

    <div class="summary">                
      <div class="total">
        <span class="label">
          <span {% if settings.enable_multilang %}data-translate="cart.label.total"{% endif %}>
            {{ 'cart.label.total' | t }}:
          </span>
        </span>
        <span class="price">
          {{cart.total_price | money}}
        </span> 
      </div>
      
        {%- comment -%}
          Payment plan - ViaBill or Sezzle
        {%- endcomment -%}
        {%- include 'payment-plan', price_for_plan: cart.total_price -%}

    </div>

    <div class="actions">
      
      {{ bold_ro_cart }}
      
      <button class="btn btn-checkout" onclick="window.location='/checkout'" {% if settings.enable_multilang %}data-translate="cart.general.checkout"{% endif %}>
        {{ 'cart.general.checkout' | t }}
      </button>
      <a class="btn btn-view-cart" href="/cart" {% if settings.enable_multilang %}data-translate="cart.general.view_cart"{% endif %}>
        {{ 'cart.general.view_cart' | t }}
      </a>      
    </div>
  </div>

  {% include 'product-delivery-estimate' %}  

{%- endcomment -%}
</div>